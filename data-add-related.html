<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>API Client: Adding related records</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">API Client
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">index</a></li><li class="navelem"><a class="el" href="_data.html">Working with data</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Adding related records </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Most records in 1CRM have other related recors linked to them. For example, Contact can have a number of related accounts. To add a related record, use the <a class="el" href="class_one_c_r_m_1_1_a_p_i_client_1_1_model.html#a8fc858f7f8ebdd2108b5cc88f6356bd9">Model::addRelated()</a> method.</p>
<p>In the following example, we get a list of accounts related to a Contact, and add all those accounts to another contact:</p>
<div class="fragment"><div class="line">$srcContactId = <span class="stringliteral">&#39;7eba2a01-6cb6-f38c-d4c2-5a8fc2def9d2&#39;</span>;</div>
<div class="line">$dstContactId = <span class="stringliteral">&#39;75a60da5-4f35-0574-d768-5a8fc2fca882&#39;</span>;</div>
<div class="line">$model = $client-&gt;model(<span class="stringliteral">&#39;Contact&#39;</span>);</div>
<div class="line">$result = $model-&gt;getRelated($srcContactId, <span class="stringliteral">&#39;accounts&#39;</span>);</div>
<div class="line">$account_ids = array_map(<span class="keyword">function</span>($account) {<span class="keywordflow">return</span> $account[<span class="stringliteral">&#39;id&#39;</span>];}, $result-&gt;getRecords());</div>
<div class="line">$result = $model-&gt;addRelated($dstContactId, <span class="stringliteral">&#39;accounts&#39;</span>, $account_ids);</div>
<div class="line">echo json_encode($result, JSON_PRETTY_PRINT);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">true</span></div>
</div><!-- fragment --><p>This is the simplest form of using this method. You just pass an array of related record IDs in <code>$data</code> parameter of <a class="el" href="class_one_c_r_m_1_1_a_p_i_client_1_1_model.html#a8fc858f7f8ebdd2108b5cc88f6356bd9">Model::addRelated()</a> method.</p>
<p>Some relationships between objects are more complex, they contain not only the ID of related records, but also additional relationship data. For example, Assembly can contain multiple Products, and for each product the relationship stores the quantity of the products in this assembly. For such relationships, you need to specify additional data:</p>
<div class="fragment"><div class="line">$productId = <span class="stringliteral">&#39;ee4f2c8a-5eae-5e9c-98ad-55b9b07b4fae&#39;</span>;</div>
<div class="line">$assemblyId = <span class="stringliteral">&#39;ad3f7e05-4ab2-6c2a-a4c7-5a910640ed46&#39;</span>;</div>
<div class="line">$model = $client-&gt;model(<span class="stringliteral">&#39;Assembly&#39;</span>);</div>
<div class="line">$relations = [</div>
<div class="line">    $productId =&gt; [<span class="stringliteral">&#39;quantity&#39;</span> =&gt; 2]</div>
<div class="line">];</div>
<div class="line">$result = $model-&gt;addRelated($assemblyId, <span class="stringliteral">&#39;products&#39;</span>, $relations);</div>
<div class="line">echo json_encode($result, JSON_PRETTY_PRINT);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">true</span></div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
